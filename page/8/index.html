<!DOCTYPE html>
<html lang="zh-tw">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Tomas Lin" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="湯瑪士的部落格">
<meta property="og:url" content="https://horsekitlin.github.io/page/8/index.html">
<meta property="og:site_name" content="湯瑪士的部落格">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Tomas Lin">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="湯瑪士的部落格" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">



    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>湯瑪士的部落格</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: 
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/archives/">主頁</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">標籤</a></li>
                        
                            <li><a href="/about/">關於我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:passon.com.tw@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/passontw" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BuckleScript/" rel="tag">BuckleScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Css/" rel="tag">Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DesignPatten/" rel="tag">DesignPatten</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FunctionPrograming/" rel="tag">FunctionPrograming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IThome2018/" rel="tag">IThome2018</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IThome2023/" rel="tag">IThome2023</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leetcode/" rel="tag">Leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Material-design/" rel="tag">Material-design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MessageQueue/" rel="tag">MessageQueue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microservies/" rel="tag">Microservies</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/" rel="tag">React Native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reason/" rel="tag">Reason</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redux/" rel="tag">Redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SocketCluster/" rel="tag">SocketCluster</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sodility/" rel="tag">Sodility</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Themes/" rel="tag">Themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Translate/" rel="tag">Translate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Truffle/" rel="tag">Truffle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VSCode/" rel="tag">VSCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ithome-12/" rel="tag">ithome 12</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/" rel="tag">spring-boot</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">主頁</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">標籤</a></li>
                
                    <li><a href="/about/">關於我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:passon.com.tw@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/passontw" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-TypeScript-ReactAndWebpack" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/31/TypeScript-ReactAndWebpack/" class="article-date">
      <time datetime="2017-10-31T08:28:11.000Z" itemprop="datePublished">2017-10-31</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/31/TypeScript-ReactAndWebpack/">TypeScript-ReactAndWebpack</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="參考來源"><a href="#參考來源" class="headerlink" title="參考來源"></a>參考來源</h1><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/react-&-webpack.html">React &amp; Webpack</a></p>
<h1 id="React-Webpack"><a href="#React-Webpack" class="headerlink" title="React &amp; Webpack"></a>React &amp; Webpack</h1><p>這一個篇章會帶你使用 <code>TypeScript</code> 使用 webpack 開發 React</p>
<p>如果你還不知道如何初始化一個新的 React 可以參考這篇<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/samples/index.html">文章</a></p>
<p>換句話說，我們假設你已經會使用 nodejs 和 npm</p>
<h2 id="Lay-out-the-project"><a href="#Lay-out-the-project" class="headerlink" title="Lay out the project"></a>Lay out the project</h2><p>開始建立一個新的資料夾 <code>proj</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> proj &amp;&amp; <span class="built_in">cd</span> proj</span><br></pre></td></tr></table></figure>

<p>然後我們建立一個新的資料結構</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proj/</span><br><span class="line">├─ dist/</span><br><span class="line">└─ <span class="attribute">src</span>/</span><br><span class="line">   └─ components/</span><br></pre></td></tr></table></figure>

<p><code>TypeScript</code> 放置於 <code>src</code> 的資料夾中，經過 <code>TypeScript compiler</code> 後再經由 <code>Webpack</code> 最後在 <code>dist</code> 產生一個 <code>bundle.js</code> 的檔案，每一個 components 都會放在　<code>src/components</code> 的資料夾內</p>
<h2 id="初始化專案"><a href="#初始化專案" class="headerlink" title="初始化專案"></a>初始化專案</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>yarn init</span><br><span class="line"><span class="variable">$ </span>yarn add react react-dom</span><br><span class="line"><span class="variable">$ </span>yarn add <span class="variable">@types</span>/react <span class="variable">@types</span>/react-dom -D</span><br></pre></td></tr></table></figure>

<p><code>types/</code> 這類的套件代表我們需要他取得 <code>TypeScript</code> 的宣告，通常當你 import 一個套件路徑 <code>react</code>，才找得到 <code>react</code> 的套件，然而並不是所有套件都需要這種宣告套件<br>，然而並不是所有套件都需要這種宣告套件</p>
<p>安裝開發用套件</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="built_in">add</span> typescript awesome-typescript-loader <span class="keyword">source</span>-<span class="keyword">map</span>-loader -D</span><br></pre></td></tr></table></figure>

<p>這兩個套件一起幫你編譯你的程式碼， <code>awesome-typescript-loader</code> 會依據 <code>tsconfig.json</code> 這個檔案所描述的 <code>TypeScript</code> 標準來做編譯。</p>
<p>而 <code>source-map-loader</code> 可以在你開發的時候可以做編譯前與編譯後的 mapping 方便追蹤錯誤的程式碼</p>
<h2 id="增加-TypeScript-設定檔案"><a href="#增加-TypeScript-設定檔案" class="headerlink" title="增加 TypeScript 設定檔案"></a>增加 TypeScript 設定檔案</h2><p>若你希望你的 <code>TypeScript</code> 整合在一起，你需要一個 <code>tsconfig.json</code> </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noImplicitAny&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;commonjs&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/**/*&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>若是你希望學習更多的 <code>tsconfig.json</code> 可以參考這篇<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/tsconfig-json.html">文章</a></p>
<h2 id="範例程式"><a href="#範例程式" class="headerlink" title="範例程式"></a>範例程式</h2><p>在 <code>src/components</code> 建立一個新的 <code>Hello.tsx</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">HelloProps</span> &#123;</span><br><span class="line">  <span class="attr">compiler</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">framework</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Hello</span> = (<span class="params"><span class="attr">props</span>: <span class="title class_">HelloProps</span></span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    Hello from &#123;props.compiler&#125; and &#123;props.framework&#125;!</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>然後在 <code>src</code> 中新增一個 <code>index.tsx</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Hello</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./components/Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> <span class="attr">compiler</span>=<span class="string">&quot;TypeScript&quot;</span> <span class="attr">framework</span>=<span class="string">&quot;React&quot;</span> /&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;example&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在 <code>index.tsx</code> 中只是引入了 <code>Hello.tsx</code> 然後將 Hello component 顯示在頁面上</p>
<p>為了顯示這個 component 我們需要建立一個 <code>index.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello React!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Dependencies --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/react/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/react-dom/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Main --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./dist/bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="建立一個-webpack-設定檔案"><a href="#建立一個-webpack-設定檔案" class="headerlink" title="建立一個 webpack 設定檔案"></a>建立一個 webpack 設定檔案</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./src/index.tsx&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    <span class="attr">path</span>: __dirname + <span class="string">&quot;/dist&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">devtool</span>: <span class="string">&quot;source-map&quot;</span>,</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">extensions</span>: [<span class="string">&quot;.ts&quot;</span>, <span class="string">&quot;.tsx&quot;</span>, <span class="string">&quot;.js&quot;</span>, <span class="string">&quot;.json&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.tsx?$/</span>, <span class="attr">loader</span>: <span class="string">&quot;awesome-typescript-loader&quot;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">enforce</span>: <span class="string">&quot;pre&quot;</span>, <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">loader</span>: <span class="string">&quot;source-map-loader&quot;</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">externals</span>: &#123;</span><br><span class="line">    <span class="attr">react</span>: <span class="string">&quot;React&quot;</span>,</span><br><span class="line">    <span class="string">&quot;react-dom&quot;</span>: <span class="string">&quot;ReactDOM&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>你可能會好奇 <code>externals</code> 這個欄位在做什麼的？</p>
<p>我們希望在打包的時候希望可以共用一些 package 就好像 <code>global variable</code> 就像 <code>jQuery</code> 或是 <code>_</code> 一樣</p>
<p>這叫做 <code>namespace pattern</code>， webpack 允許我們使用這個方式來引用套件。</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>webpack</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translate/" rel="tag">Translate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Typescript-MigratingFromJavascript" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/30/Typescript-MigratingFromJavascript/" class="article-date">
      <time datetime="2017-10-30T09:33:48.000Z" itemprop="datePublished">2017-10-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/30/Typescript-MigratingFromJavascript/">Typescript-Migrating from Javascript</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="翻譯來源"><a href="#翻譯來源" class="headerlink" title="翻譯來源"></a>翻譯來源</h1><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/react-&-webpack.html">Migrating from JavaScript
</a></p>
<h1 id="從-Javascript-搬移你的程式到-TypeScript"><a href="#從-Javascript-搬移你的程式到-TypeScript" class="headerlink" title="從 Javascript 搬移你的程式到 TypeScript"></a>從 Javascript 搬移你的程式到 TypeScript</h1><p><code>TypeScript</code> 不會憑空存在， 他還是依存於 <code>Javascript</code> 的生態圈內，有很多舊的 <code>Javascript</code> 要轉譯為 <code>TypeScript</code> 過程中很無趣的。</p>
<p>如果你是要轉譯 <code>React project</code> 我們會推薦你先閱讀這份<a target="_blank" rel="noopener" href="https://github.com/Microsoft/TypeScript-React-Conversion-Guide#typescript-react-conversion-guide">文件</a></p>
<h2 id="設定你的資料結構"><a href="#設定你的資料結構" class="headerlink" title="設定你的資料結構"></a>設定你的資料結構</h2><p>基本的檔案架構會如下</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">projectRoot</span><br><span class="line">├── src</span><br><span class="line">│   ├── file1.<span class="keyword">js</span></span><br><span class="line"><span class="keyword"></span>│   └── file2.<span class="keyword">js</span></span><br><span class="line"><span class="keyword"></span>├── <span class="keyword">built</span></span><br><span class="line"><span class="keyword"></span>└── tsconfig.<span class="keyword">json</span></span><br></pre></td></tr></table></figure>

<p>如果你有想要用測試的話，在 <code>src</code> 再加上 <code>tests</code> 並且在 <code>tsconfig.json</code> 除了 <code>src</code> 之外再加上 <code>tests</code></p>
<h2 id="寫一個設定檔案"><a href="#寫一個設定檔案" class="headerlink" title="寫一個設定檔案"></a>寫一個設定檔案</h2><p><code>TypeScript</code> 使用 <code>tsconfig.json</code> 來做專案的設定</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./built&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;allowJs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;./src/**/*&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>我們利用這個設定檔案 對 <code>TypeScript</code> 做一些設定</p>
<ol>
<li>包含 <code>include</code> 讀取 <code>src</code> 中所有檔案</li>
<li>允許 <code>Javascript</code> 文件直接輸入</li>
<li>可以在 <code>build</code> 輸出所有編譯後文件</li>
<li>將 ES6或是ES7 轉譯為 ES5</li>
</ol>
<p>如果你是使用 <code>tsc</code> 轉譯你的專案，你應該會在 <code>built</code> 資料夾裡面看到編譯成功的檔案</p>
<h3 id="優勢"><a href="#優勢" class="headerlink" title="優勢"></a>優勢</h3><p>如果你使用的是<a target="_blank" rel="noopener" href="https://code.visualstudio.com/">VS code</a> 或是 <a target="_blank" rel="noopener" href="https://visualstudio.com/">Visual Studio</a> 你可以使用相當多的工具，例如自動完成。也可以增加一些設定方便你 <code>debug</code></p>
<ul>
<li><code>noImplicitReturns</code> 可以防止你在 function 的最後忘記回傳值</li>
<li><code>noFallthroughCasesInSwitch</code> 可以協助你補上 <code>break</code> 在 <code>switch</code> 中的 <code>case</code></li>
</ul>
<p><code>TypeScript</code> 依舊會對無法訪問的標籤的錯誤顯示，你可以利用 <code>allowUnreachableCode</code> 和 <code>allowUnusedLabels</code> 來取消</p>
<h3 id="整合你的編譯工具"><a href="#整合你的編譯工具" class="headerlink" title="整合你的編譯工具"></a>整合你的編譯工具</h3><p>每個人都有自己的編譯步驟</p>
<p>下個範例是我們覺得目前最佳的方式</p>
<h4 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h4><p>相關的 <code>gulp</code> 使用可以參考我們另外一個<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/gulp.html">文件</a></p>
<h4 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h4><p><code>Webpack</code> 是一個相當簡單的工具！</p>
<p>你可以使用 <code>awesome-typescript-loader</code> 這是一個 <code>TypeScript</code> Loader</p>
<p>另外也可以使用 <code>source-map-loader</code> 讓你更易於 debug</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="built_in">add</span> awesome-typescript-loader <span class="keyword">source</span>-<span class="keyword">map</span>-loader</span><br></pre></td></tr></table></figure>

<p>將上述兩個套件加入你的 <code>webpack.config.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.ts&#x27;</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;./dist/bundle.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">devtool</span>: <span class="string">&#x27;source-map&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">extensions</span>: [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;webpack.js&#x27;</span>, <span class="string">&#x27;.web.js&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>, <span class="string">&#x27;js&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">moudle</span>: &#123;</span><br><span class="line">    <span class="attr">loaders</span>: [</span><br><span class="line">      &#123;<span class="attr">test</span>: <span class="regexp">/\.tsx?$/</span>, <span class="attr">loader</span>: <span class="string">&#x27;awesome-typescript-loader&#x27;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="attr">preLoaders</span>: [</span><br><span class="line">      &#123;<span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">loader</span>: <span class="string">&#x27;source-map-loader&#x27;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>awesome-typescript-load</code> 必須在所有的 loader 的前面 <code>ts-loader</code> 也是一樣的道理，你可以在<a target="_blank" rel="noopener" href="https://github.com/s-panferov/awesome-typescript-loader#differences-between-ts-loader">這邊</a>獲得更多資訊</p>
<h3 id="將-js-轉換成為-ts"><a href="#將-js-轉換成為-ts" class="headerlink" title="將 .js 轉換成為 .ts"></a>將 .js 轉換成為 .ts</h3><p>我們可以開始對檔案做一些動作開始轉換</p>
<p>第一個步驟就是將所有的 <code>.js</code> 換成 <code>.ts</code></p>
<p>若是你的檔案有使用 <code>JSX</code> 則需要將檔案名稱換成 <code>.tsx</code></p>
<p>當然你會覺得怪怪的，這樣就結束了麻？</p>
<p>當然不是！</p>
<p>接著你可以打開你的編輯器或是使用 <code>command line</code></p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tsc <span class="comment">--pretty</span></span><br></pre></td></tr></table></figure>

<p>你可以看到一些 <code>紅色</code> 的波浪底線</p>
<p>這些就像是 微軟的 word 軟體提醒你這些並不符合 <code>TypeScript</code> 的規範</p>
<p>如果這些對你說太寬鬆，你希望可以更加嚴謹的話你也可以使用 <code>noEmitOnError</code> 這一個選項來讓檢查更加嚴謹</p>
<p>如果你希望使用嚴謹模式可以參考這篇<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/migrating-from-javascript.html#getting-stricter-checks">文章</a></p>
<p>例如你不希望變數型態使用不明確的 <code>any</code> 你可以在編輯檔案之前使用 <code>noImplicitAny</code>。</p>
<h4 id="解決錯誤相關問題"><a href="#解決錯誤相關問題" class="headerlink" title="解決錯誤相關問題"></a>解決錯誤相關問題</h4><p>就像剛剛提到的，你會修改 <code>.js</code> 為 <code>.ts</code> 或是 <code>.tsx</code> 的時候會有相當多的錯誤訊息</p>
<p>你會發現這些錯誤雖然是屬於合法的錯誤，但是透過這些錯誤可以發現 <code>TypeScript</code> 對你開發程式碼的好處。</p>
<h5 id="import-模組"><a href="#import-模組" class="headerlink" title="import 模組"></a>import 模組</h5><p>你可能會得到錯誤訊息是 <code>Cannot find name &#39;require&#39;</code> 或是 <code>Cannot find name &#39;deffined&#39;</code></p>
<p>在這些狀況在這些狀況應該是 <code>TypeScript</code> 找不到這些模組</p>
<p>你需要預先選擇使用引入模組的方式，可以使用 <code>commonjs</code>, <code>amd</code>, <code>system</code> 和 <code>umd</code></p>
<p>如果你有使用 Nod&#x2F;CommonJS </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="built_in">require</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">foo.<span class="title function_">doStuff</span>();</span><br></pre></td></tr></table></figure>

<p>或是 RequireJS&#x2F;AMD</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>([<span class="string">&quot;foo&quot;</span>], <span class="keyword">function</span>(<span class="params">foo</span>)&#123;</span><br><span class="line">  foo.<span class="title function_">doStuff</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>你可以修改為</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> foo = <span class="built_in">require</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">foo.<span class="title function_">doStuff</span>();</span><br></pre></td></tr></table></figure>

<h5 id="TypeScript-的宣告"><a href="#TypeScript-的宣告" class="headerlink" title="TypeScript 的宣告"></a>TypeScript 的宣告</h5><p>如果你編譯檔案的時候有安裝 <code>foo</code> module</p>
<p>但是依然看到 <code>Cannot find module &#39;foo&#39;</code></p>
<p>這個錯誤訊息，很有可能是你並未有宣告的檔案來宣告你的 library，</p>
<p>要處理這個問題也很簡單</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>yarn add <span class="variable">@types</span>/lodash -D</span><br></pre></td></tr></table></figure>

<p>如果你有使用 module 選項是 <code>commonjs</code> 你另外需要設定 <code>moduleResolution</code> 為 <code>node</code></p>
<p>然後你才可以正常沒有錯誤訊息的引用 lodash</p>
<h5 id="Export-模組"><a href="#Export-模組" class="headerlink" title="Export 模組"></a>Export 模組</h5><p>通常在 export 模組的時候都是使用 <code>export</code> 或是 <code>module.exports</code></p>
<p><code>TypeScript</code> 允許你使用 <code>export</code> 參數，例如:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">feedPets</span> = <span class="keyword">function</span>(<span class="params">pets</span>)&#123;</span><br><span class="line">  <span class="comment">//....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你可以改為 </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">feedPets</span>(<span class="params">pets</span>)&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有時候你會直接複寫 <code>exports object</code></p>
<p>這是屬於 <code>commonJS</code> 的設計</p>
<p>在引用這類的模組的時候</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br></pre></td></tr></table></figure>

<p>你在之前會有像這樣的範例程式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = foo;</span><br></pre></td></tr></table></figure>

<p>在 <code>TypeScript</code> 你可以修改為 export &#x3D; consturct</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> = foo;</span><br></pre></td></tr></table></figure>

<p>有時候你呼叫函式的時候會有太多或是太少的參數，</p>
<p>通常這是一種 bug</p>
<p>但是在有些狀況中你可以宣告函示使用 <code>arguments object</code> 來代替寫出的所有參數</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myCoolFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> == <span class="number">2</span> &amp;&amp; <span class="title class_">Array</span>.<span class="title function_">isArray</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> arr = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    arr.<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title function_">f</span>(value));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> arr = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arguments: &quot;</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">myCoolFunction</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  &#125;,</span><br><span class="line">  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">);</span><br><span class="line"><span class="title function_">myCoolFunction</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">2</span>,</span><br><span class="line">  <span class="number">3</span>,</span><br><span class="line">  <span class="number">4</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>result:</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">arguments:  &#123; <span class="string">&#x27;0&#x27;</span>: [<span class="keyword">Function</span>], <span class="string">&#x27;1&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;2&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;4&#x27;</span>: <span class="number">4</span> &#125;</span><br></pre></td></tr></table></figure>

<p>在這個範例中因為有兩種 input 方式</p>
<p>所以在 <code>TypeScript</code> 需要改為</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myCoolFunction</span>(<span class="params"><span class="attr">f</span>: (x: <span class="built_in">number</span>) =&gt; <span class="built_in">void</span>, <span class="attr">nums</span>: <span class="built_in">number</span>[]</span>): <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myCoolFunction</span>(<span class="params"><span class="attr">f</span>: (x: <span class="built_in">number</span>) =&gt; <span class="built_in">void</span>, ...<span class="attr">nums</span>: <span class="built_in">number</span>[]</span>): <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myCoolFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> == <span class="number">2</span> &amp;&amp; <span class="title class_">Array</span>.<span class="title function_">isArray</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> arr = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    arr.<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title function_">f</span>(value));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> arr = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arguments: &quot;</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">myCoolFunction</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  &#125;,</span><br><span class="line">  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">);</span><br><span class="line"><span class="title function_">myCoolFunction</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">2</span>,</span><br><span class="line">  <span class="number">3</span>,</span><br><span class="line">  <span class="number">4</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tsc src/demo1.ts &amp;&amp; <span class="keyword">node</span> <span class="title">src</span>/demo1.js</span><br></pre></td></tr></table></figure>

<p>result</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">arguments:  &#123; <span class="string">&#x27;0&#x27;</span>: [<span class="keyword">Function</span>], <span class="string">&#x27;1&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;2&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;4&#x27;</span>: <span class="number">4</span> &#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>TypeScript</code> 中宣告了 myCoolFunction 兩個不同的宣告，</p>
<p>定義一個 f 為 <code>function : (x: number) =&gt; void</code></p>
<p>然後也對多個變數使用 <code>...nums: number[]</code> 來宣告是一個數字陣列</p>
<h5 id="增加參數"><a href="#增加參數" class="headerlink" title="增加參數"></a>增加參數</h5><p>有些人對一個物件增加參數使用下述方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> options = &#123;&#125;;</span><br><span class="line">options.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">options.<span class="property">volume</span> = <span class="number">11</span>;</span><br></pre></td></tr></table></figure>

<p><code>TypeScript</code> 則會表示這樣無法新增 color 和 volume 因為 property 不存在</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Options</span> &#123;<span class="attr">color</span>: <span class="built_in">string</span>, <span class="attr">volume</span>: <span class="built_in">number</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> options = &#123;&#125;; <span class="comment">// Error</span></span><br><span class="line"><span class="keyword">var</span> options = &#123;&#125; <span class="keyword">as</span> <span class="title class_">Options</span>; <span class="comment">// Success</span></span><br><span class="line"></span><br><span class="line">options.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">options.<span class="property">volume</span> = <span class="number">11</span>;</span><br></pre></td></tr></table></figure>

<p>你可以將 type 定義為 <code>object</code> 或是 <code>&#123;&#125;</code> 這樣也可以自由地增加物件特性，但是比較常使用的是 <code>any</code> 來宣告這類型自由的型態</p>
<p>例如你有一個物件類型宣告為 <code>object</code> 你將無法呼叫 <code>toLowerCase()</code> 這個函式，但是若是你宣告的是 <code>any</code> 的類型的話，就可以呼叫這個函式。也就是當你宣告為 <code>any</code> 這個類型的話就不會有太多的錯誤提示你的型別問題</p>
<h5 id="嚴謹模式"><a href="#嚴謹模式" class="headerlink" title="嚴謹模式"></a>嚴謹模式</h5><p><code>TypeScript</code> 可以幫你檢查並且分析你的程式，讓你的錯誤減少</p>
<h6 id="不推薦使用-any"><a href="#不推薦使用-any" class="headerlink" title="不推薦使用 any"></a>不推薦使用 any</h6><p>使用了 <code>any</code> 這個類型會造成遇到錯誤時 <code>TypeScript</code> 也不會提醒你，也就喪失使用 <code>TypeScript</code> 的意義，你可以設定 <code>noImplicitAny</code> 這個選項來控制禁止使用 <code>any</code></p>
<h5 id="更嚴謹的檢查-undefined-和-null"><a href="#更嚴謹的檢查-undefined-和-null" class="headerlink" title="更嚴謹的檢查 undefined 和 null"></a>更嚴謹的檢查 undefined 和 null</h5><p>在 <code>TypeScript</code> 中 <code>undefined</code> 和 <code>null</code> 的類型宣告都是 <code>any</code>，但是 <code>undefined</code>和 <code>null</code> 在 <code>Javascript</code> 和 <code>TypeScript</code> 造成許多的 Bug，所以你可以設定 <code>strictNullChecks</code> 來做更嚴謹的檢查。</p>
<p>當你設定 <code>strictNullChecks</code> 的時候 <code>undefined</code> 和 <code>null</code> 也會擁有他們自己的類型 <code>undefined</code> 和 <code>null</code> ， 若是有些變數同時可能是數字或是 null 的時候，可以利用 <code>union</code> 來宣告類型， 例如</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">var</span> <span class="attr">foo</span>: <span class="built_in">string</span>[] | <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">foo.<span class="property">length</span>; <span class="comment">// error - &#x27;foo&#x27; 有可能是null</span></span><br><span class="line">foo!.<span class="property">length</span>; <span class="comment">// okay - foo! 只可能是 &#x27;string[]&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="不可宣告-this-為-any"><a href="#不可宣告-this-為-any" class="headerlink" title="不可宣告 this 為 any"></a>不可宣告 this 為 any</h4><p>當你使用 <code>this</code> 這個keyword 的時候，預設是 <code>any</code>，例如</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> x, <span class="keyword">public</span> y</span>)&#123;&#125;</span><br><span class="line">  <span class="title function_">getDistance</span>(<span class="params"><span class="attr">p</span>: <span class="title class_">Point</span></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> dx = p.<span class="property">x</span> - <span class="variable language_">this</span>.<span class="property">x</span>;</span><br><span class="line">    <span class="keyword">let</span> dy = p.<span class="property">y</span> - <span class="variable language_">this</span>.<span class="property">y</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(dx ** <span class="number">2</span> + dy ** <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Point</span>&#123;</span><br><span class="line">  <span class="title function_">distanceFromOrigin</span>(<span class="attr">point</span>: <span class="title class_">Point</span>): <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Point</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">distanceFromOrigin</span> = <span class="keyword">function</span>(<span class="params"><span class="attr">point</span>: <span class="title class_">Point</span></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getDistance</span>(&#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>這部分就像我們上面談的問題其實是一樣的</p>
<p>我們沒辦法去檢查 <code>this</code> 這個變數的型態</p>
<p><code>TypeScript</code> 也有一個 <code>noImplicitThis</code> 的選項</p>
<p>當這個選項被設定為 true 的時候， <code>TypeScript</code> 會提醒你在使用 <code>this</code> 時要設定型態</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Poing</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">distanceFromOrigin</span> = <span class="keyword">function</span>(<span class="params"><span class="attr">this</span>: <span class="title class_">Point</span>, <span class="attr">point</span>: <span class="title class_">Point</span></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getDistance</span>(&#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translate/" rel="tag">Translate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Typescript-Gulp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/29/Typescript-Gulp/" class="article-date">
      <time datetime="2017-10-29T14:21:39.000Z" itemprop="datePublished">2017-10-29</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/29/Typescript-Gulp/">TypeScriptWithGulp</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="翻譯來源"><a href="#翻譯來源" class="headerlink" title="翻譯來源"></a>翻譯來源</h1><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/gulp.html">TypeScriptWithGulp</a></p>
<h1 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h1><p>此篇是使用 <code>TypeScript</code> 和 <code>Gulp</code> 並且利用 <code>Gulp</code> 的 pipeline增加 <code>Browserify</code> , <code>uglify</code> 或 <code>watchify</code> 以及 <code>Babelify</code>等等功能</p>
<h2 id="Minimal-project"><a href="#Minimal-project" class="headerlink" title="Minimal project"></a>Minimal project</h2><p>在此範例中建立一個資料夾  <code>proj</code> 但是你可以建立一個你希望的名字的資料夾</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> proj</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> proj</span></span><br></pre></td></tr></table></figure>

<p>先簡單建立資料結構</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proj/</span><br><span class="line"> ├─ <span class="attribute">src</span>/</span><br><span class="line"> └─ dist/</span><br></pre></td></tr></table></figure>

<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> src dist</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yarn init</span></span><br></pre></td></tr></table></figure>

<h3 id="安裝相關的套件"><a href="#安裝相關的套件" class="headerlink" title="安裝相關的套件"></a>安裝相關的套件</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g gulp-<span class="keyword">cli</span></span><br><span class="line">$ yarn <span class="keyword">add</span> typescript gulp gulp-typescript -D</span><br></pre></td></tr></table></figure>

<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>在 <code>src</code> 中建立一個新的 <code>main.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"><span class="attr">compiler</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello from <span class="subst">$&#123;compiler&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hello</span>(<span class="string">&quot;TypeScript&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>在 <code>proj</code> 中建立一個 <code>tsconfig.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/main.ts&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;noImplicitAny&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>建立一個 gulpfile.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ts = <span class="built_in">require</span>(<span class="string">&quot;gulp-typescript&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> tsProject = ts.<span class="title function_">createProject</span>(<span class="string">&quot;tsconfig.json&quot;</span>);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;default&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> tsProject.<span class="title function_">src</span>()</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">tsProject</span>())</span><br><span class="line">        .<span class="property">js</span>.<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="測試-App"><a href="#測試-App" class="headerlink" title="測試 App"></a>測試 App</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ gulp</span><br><span class="line">$ <span class="keyword">node</span> <span class="title">dist</span>/main.js</span><br><span class="line">//result: Hello from TypeScript</span><br></pre></td></tr></table></figure>

<h4 id="增加模組"><a href="#增加模組" class="headerlink" title="增加模組"></a>增加模組</h4><p>建立一個新的檔案 <code>src/greet.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`Hello from <span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然後再修改 <code>src/main.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sayHello &#125; <span class="keyword">from</span> <span class="string">&quot;./greet&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sayHello</span>(<span class="string">&quot;TypeScript&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>最後再修改 <code>tsconfig.json</code> 將 <code>src/greet.ts</code> 加入編譯</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/main.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;src/greet.ts&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;noImplicitAny&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="執行"><a href="#執行" class="headerlink" title="執行"></a>執行</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gulp &amp;&amp; <span class="keyword">node</span> <span class="title">dist</span>/main.js</span><br></pre></td></tr></table></figure>

<p>然後就可以看到編譯後執行的結果</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello <span class="keyword">from</span> TypeScript</span><br></pre></td></tr></table></figure>

<p><code>Note: 雖然我們使用 ES2015 但是 TypeScript 使用 commonJS 模組，但是你也可以在 options 中設定 module 來改變它</code></p>
<h4 id="Browserify"><a href="#Browserify" class="headerlink" title="Browserify"></a>Browserify</h4><p>我們開始寫前端的程式</p>
<p>我們希望可以把所有 modules 打包到一個 Javascript 檔案</p>
<p>而這些事情就是 <code>browserify</code> 所做的事情，而這會使用到 <code>CommonJS</code> 模組，而這也正好是 <code>TypeScript</code> 預設使用的，也就是我們可以在 <code>TypeScript</code> 直接使用 <code>browserify</code></p>
<p>先安裝 <code>browserify</code>, <code>tsify</code>, <code>vinyl-source-stream</code></p>
<p><code>tsify</code> 是 browserify 的 plugin 做的事情就像是 <code>gulp-typescript</code> 一樣，而<code>vinyl-source-stream</code> 則是提供一種方便我們了解的檔案輸出格式</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="keyword">add </span><span class="keyword">browserify </span>tsify vinyl-source-stream -D</span><br></pre></td></tr></table></figure>

<p>在 <code>src</code> 中建立一個 index.html 的檔案</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;greeting&quot;</span>&gt;</span>Loading ...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然後修改 <code>main.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sayHello &#125; <span class="keyword">from</span> <span class="string">&quot;./greet&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showHello</span>(<span class="params"><span class="attr">divName</span>: <span class="built_in">string</span>, <span class="attr">name</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> elt = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(divName);</span><br><span class="line">  elt.<span class="property">innerText</span> = <span class="title function_">sayHello</span>(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">showHello</span>(<span class="string">&quot;greeting&quot;</span>, <span class="string">&quot;TypeScript&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>接著再修改 gulpfile.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> browserify = <span class="built_in">require</span>(<span class="string">&#x27;browserify&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> source = <span class="built_in">require</span>(<span class="string">&#x27;vinyl-source-stream&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> tsify = <span class="built_in">require</span>(<span class="string">&#x27;tsify&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> paths = &#123;</span><br><span class="line">  <span class="attr">pages</span>: [<span class="string">&#x27;src/*.html&#x27;</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;copy-html&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(paths.<span class="property">pages</span>)</span><br><span class="line">  .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;default&#x27;</span>, [<span class="string">&#x27;copy-html&#x27;</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">browserify</span>(&#123;</span><br><span class="line">    <span class="attr">basedir</span>: <span class="string">&#x27;.&#x27;</span>,</span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">entries</span>: [<span class="string">&#x27;src/main.ts&#x27;</span>],</span><br><span class="line">    <span class="attr">cache</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">packageCache</span>: &#123;&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">plugin</span>(tsify)</span><br><span class="line">  .<span class="title function_">bundle</span>()</span><br><span class="line">  .<span class="title function_">pipe</span>(<span class="title function_">source</span>(<span class="string">&#x27;bundle.js&#x27;</span>))</span><br><span class="line">  .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;dist&#x27;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>增加一個 <code>copy-html</code> 的task 並且將其加入在 <code>default</code> 的 task中，也就是代表當 <code>default</code>執行的時候會先執行 <code>copy-html</code> 並且也修改 <code>default</code> 的 function 加入呼叫 <code>Browserify</code> 和 <code>tsify</code> 的 plugin，將 <code>tsify</code> 取代 <code>gulp-typescript</code> 也丟入一些參數在 <code>Browserify</code> 之中, 在 bundle 之後 再利用 <code>vinyl-source-stream</code> 輸出檔案 <code>bundle.js</code></p>
<p>然後我們可以執行之後再用瀏覽器開啟 <code>dist/index.html</code>來觀看結果</p>
<p><code>Note: 設定 debug: true 是因為 在打包成為一個檔案之後， SourceMap 可以對照你打包後的檔案，當你發生錯誤的時候，就可以找到相關錯誤位置，提高 debug 的效率</code></p>
<h4 id="watchify-Babel-and-Uglify"><a href="#watchify-Babel-and-Uglify" class="headerlink" title="watchify, Babel and Uglify"></a>watchify, Babel and Uglify</h4><p>現在我們已經有 <code>tsify</code>, <code>browserify</code> 我們還可以再加入一些套件</p>
<ul>
<li><p><code>Watcherify</code> 利用 <code>gulp</code> 啟動，可以保證程式持續執行，並且在修改後同步修改重啟，你的瀏覽器也可以立即 refresh 觀看結果</p>
</li>
<li><p>Babel 是一個大型並且彈性的編譯 Lib 可以將 ES2015 轉回 ES5 和 ES3，可以自行增加擴充編譯套件，而這些是 <code>typescript</code> 沒有支援的</p>
</li>
<li><p><code>Uglify</code> 則是將你的程式最小化，讓你下載的時間可以大大減少下載的時間</p>
</li>
</ul>
<h5 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h5><p>安裝 watchify和 gulp-util</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="built_in">add</span> watchify gulp-util -D</span><br></pre></td></tr></table></figure>

<p>再修改 <code>gulpfile.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> browserify = <span class="built_in">require</span>(<span class="string">&quot;browserify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> source = <span class="built_in">require</span>(<span class="string">&quot;vinyl-source-stream&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> tsify = <span class="built_in">require</span>(<span class="string">&quot;tsify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> watchify = <span class="built_in">require</span>(<span class="string">&#x27;watchify&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> gutil = <span class="built_in">require</span>(<span class="string">&#x27;gulp-util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> watchedBrowserify = <span class="title function_">watchify</span>(<span class="title function_">browserify</span>(&#123;</span><br><span class="line">    <span class="attr">basedir</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">entries</span>: [<span class="string">&quot;src/main.ts&quot;</span>],</span><br><span class="line">    <span class="attr">cache</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">packageCache</span>: &#123;&#125;</span><br><span class="line">&#125;)).<span class="title function_">plugin</span>(tsify);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> paths = &#123;</span><br><span class="line">  <span class="attr">pages</span>: [<span class="string">&quot;src/*.html&quot;</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;copy-html&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(paths.<span class="property">pages</span>).<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bundle</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> watchedBrowserify</span><br><span class="line">    .<span class="title function_">bundle</span>()</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">source</span>(<span class="string">&quot;bundle.js&quot;</span>))</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;default&quot;</span>, [<span class="string">&quot;copy-html&quot;</span>],bundle);</span><br><span class="line"></span><br><span class="line">watchedBrowserify.<span class="title function_">on</span>(<span class="string">&#x27;update&#x27;</span>, bundle);</span><br><span class="line">watchedBrowserify.<span class="title function_">on</span>(<span class="string">&#x27;log&#x27;</span>, gutil.<span class="property">log</span>);</span><br></pre></td></tr></table></figure>

<p><code>gulpfile.js</code>做了三個改變</p>
<ol>
<li>在 <code>browserify</code> 外面包覆了一層 <code>watchify</code></li>
<li>我們監聽了 <code>watchedBrowserify</code> 的 update Event 每次修改的時候就會自動重新打包並產生新增檔案到 <code>dist</code> 到資料夾內</li>
<li>我們也監聽了 <code>log</code> 的 Event 使用 <code>gulp-util</code> 的 log 來做紀錄顯示</li>
</ol>
<p>綜合以上 1, 2 的步驟我們將 <code>browserify</code> 移出了 <code>default task</code> 放到了 function <code>bundle</code>裡然後透過 監聽 <code>update</code> 的 Event 來隨時重新編譯程式</p>
<p>而 3 則是會列印出過程的訊息方便我們開發程式的時候查閱</p>
<p>然後我們開始啟動則會看到下方的訊息</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">16</span>:<span class="number">31</span>:<span class="number">53</span>] <span class="symbol">Starting</span> <span class="string">&#x27;copy-html&#x27;</span>...</span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">53</span>] <span class="symbol">Finished</span> <span class="string">&#x27;copy-html&#x27;</span> after <span class="number">15</span> ms</span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">53</span>] <span class="symbol">Starting</span> <span class="string">&#x27;default&#x27;</span>...</span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">54</span>] <span class="number">2690</span> bytes written (<span class="number">0.09</span> seconds)</span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">54</span>] <span class="symbol">Finished</span> <span class="string">&#x27;default&#x27;</span> after <span class="number">1.12</span> s</span><br></pre></td></tr></table></figure>

<p>並且當你修改 <code>main.ts</code> 時會自動重新編譯</p>
<p>也就是當你重新 refresh 網頁的時候</p>
<p>就可以看到最新的更新狀態</p>
<h4 id="Uglify"><a href="#Uglify" class="headerlink" title="Uglify"></a>Uglify</h4><p>因為 <code>Uglify</code> 會撕裂你的程式碼，所以需要安裝 <code>vinyl-buffer</code> 和 <code>gulp-sourcemaps</code> 來讓 <code>sourcemaps</code> 持續動作</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="keyword">add </span>gulp-uglify vinyl-<span class="keyword">buffer </span>gulp-sourcemaps -D</span><br></pre></td></tr></table></figure>

<p><code>gulpfile.js</code>修改為</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> browserify = <span class="built_in">require</span>(<span class="string">&quot;browserify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> source = <span class="built_in">require</span>(<span class="string">&quot;vinyl-source-stream&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> tsify = <span class="built_in">require</span>(<span class="string">&quot;tsify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> watchify = <span class="built_in">require</span>(<span class="string">&quot;watchify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> gutil = <span class="built_in">require</span>(<span class="string">&quot;gulp-util&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> uglify = <span class="built_in">require</span>(<span class="string">&quot;gulp-uglify&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> sourcemaps = <span class="built_in">require</span>(<span class="string">&quot;gulp-sourcemaps&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> buffer = <span class="built_in">require</span>(<span class="string">&quot;vinyl-buffer&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> watchedBrowserify = <span class="title function_">watchify</span>(</span><br><span class="line">  <span class="title function_">browserify</span>(&#123;</span><br><span class="line">    <span class="attr">basedir</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">entries</span>: [<span class="string">&quot;src/main.ts&quot;</span>],</span><br><span class="line">    <span class="attr">cache</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">packageCache</span>: &#123;&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">).<span class="title function_">plugin</span>(tsify);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> paths = &#123;</span><br><span class="line">  <span class="attr">pages</span>: [<span class="string">&quot;src/*.html&quot;</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;copy-html&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(paths.<span class="property">pages</span>).<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bundle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> watchedBrowserify</span><br><span class="line">    .<span class="title function_">bundle</span>()</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">source</span>(<span class="string">&quot;bundle.js&quot;</span>))</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;default&quot;</span>, [<span class="string">&quot;copy-html&quot;</span>], bundle);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;production&quot;</span>, [<span class="string">&#x27;copy-html&#x27;</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">browserify</span>(&#123;</span><br><span class="line">    <span class="attr">basedir</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">entries</span>: [<span class="string">&quot;src/main.ts&quot;</span>],</span><br><span class="line">    <span class="attr">cache</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">packageCache</span>: &#123;&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">    .<span class="title function_">plugin</span>(tsify)</span><br><span class="line">    .<span class="title function_">bundle</span>()</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">source</span>(<span class="string">&quot;bundle.js&quot;</span>))</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">buffer</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(sourcemaps.<span class="title function_">init</span>(&#123; <span class="attr">loadMaps</span>: <span class="literal">true</span> &#125;))</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(sourcemaps.<span class="title function_">write</span>(<span class="string">&quot;./&quot;</span>))</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">watchedBrowserify.<span class="title function_">on</span>(<span class="string">&quot;update&quot;</span>, bundle);</span><br><span class="line">watchedBrowserify.<span class="title function_">on</span>(<span class="string">&quot;log&quot;</span>, gutil.<span class="property">log</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>gulp production</span><br></pre></td></tr></table></figure>

<p><code>Note: Uglify 只需要做一次，buffer和 sourcemaps 會產生一個獨立的檔案 bundle.map.js 你也可以確認 bundle.js 中的程式事不是已經最小化了</code></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translate/" rel="tag">Translate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Typescript-TypescriptIn5Minutes" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/27/Typescript-TypescriptIn5Minutes/" class="article-date">
      <time datetime="2017-10-27T08:13:03.000Z" itemprop="datePublished">2017-10-27</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/27/Typescript-TypescriptIn5Minutes/">TypeScript-TypeScriptIn5Minutes</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="翻譯來源"><a href="#翻譯來源" class="headerlink" title="翻譯來源"></a>翻譯來源</h1><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes.html">TypeScript</a></p>
<h1 id="TypeScript-in-5-minutes"><a href="#TypeScript-in-5-minutes" class="headerlink" title="TypeScript in 5 minutes"></a>TypeScript in 5 minutes</h1><p>使用 <code>TypeScript</code> 建立第一個簡單的 網頁應用</p>
<h2 id="Installing-TypeScript"><a href="#Installing-TypeScript" class="headerlink" title="Installing TypeScript"></a>Installing TypeScript</h2><p>有兩個主要的安裝方式</p>
<ul>
<li>使用 <a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/install">NPM</a> 安裝</li>
<li>安裝 [Visual Studio plugins]</li>
</ul>
<h3 id="Visual-Studio"><a href="#Visual-Studio" class="headerlink" title="Visual Studio"></a>Visual Studio</h3><p>Visual Studio 2017 和 Visual Studio 2015 預設已經有使用 <code>TypeScript</code> ，但若是你不希望安裝 Visual Studio 你也可以安裝 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/#download-links">TypeScript</a></p>
<h3 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm <span class="keyword">install</span> -g typescript</span><br></pre></td></tr></table></figure>

<h4 id="建立你的第一個-TypeScript-檔案"><a href="#建立你的第一個-TypeScript-檔案" class="headerlink" title="建立你的第一個 TypeScript 檔案"></a>建立你的第一個 TypeScript 檔案</h4><p>greeter.ts</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greeter</span>(<span class="params">person</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> user = <span class="string">&quot;Jane User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="title function_">greeter</span>(user);</span><br></pre></td></tr></table></figure>

<h4 id="Compiling-your-code"><a href="#Compiling-your-code" class="headerlink" title="Compiling your code"></a>Compiling your code</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>tsc greeter.ts</span><br></pre></td></tr></table></figure>

<p>經過編譯，你會多了一個 <code>greeter.js</code> 的 Javascript 檔案</p>
<p>而這個檔案可以在前端或 Nodejs 中使用</p>
<p>接下來我們要開始接下來我們要開始嘗試 <code>TypeScript</code> 的幾個功能</p>
<p>就是先在 Function greeter 中的 <code>person</code> 這個參數加上類別的識別</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greeter</span>(<span class="params"><span class="attr">person</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + person;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// var user = &quot;Jane User&quot;;</span></span><br><span class="line"><span class="keyword">var</span> user = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="title function_">greeter</span>(user);</span><br></pre></td></tr></table></figure>

<p>當編譯的時候就會看到一個錯誤</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">greeter.ts(<span class="number">7</span>,<span class="number">35</span>): <span class="literal">error</span> TS2345: Argument <span class="keyword">of</span> <span class="keyword">type</span> <span class="symbol">&#x27;number</span>[]&#x27; <span class="keyword">is</span> <span class="keyword">not</span> assignable <span class="keyword">to</span> <span class="keyword">parameter</span> <span class="keyword">of</span> <span class="keyword">type</span> <span class="symbol">&#x27;string</span>&#x27;.</span><br></pre></td></tr></table></figure>

<p>同樣的若是你使用 <code>Function greeter</code> 的時候移除了參數</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greeter</span>(<span class="params"><span class="attr">person</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="title function_">greeter</span>();</span><br></pre></td></tr></table></figure>

<p>你也會得到一個錯誤訊息</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">greeter</span>.ts(<span class="number">7</span>,<span class="number">27</span>): error TS2554: Expected <span class="number">1</span> arguments, but got <span class="number">0</span>.</span><br></pre></td></tr></table></figure>

<p><code>TypeScript</code> 會協助分析你的程式並且提醒你還需要提供相關的資訊</p>
<p>雖然這些錯誤訊息提醒，但是你的 <code>greeter.js</code> 仍然會產生 <code>TypeScript</code> 僅僅會警告你這些程式碼執行會得到不是你的預期結果</p>
<h4 id="interfaces"><a href="#interfaces" class="headerlink" title="interfaces"></a>interfaces</h4><p>然後我們可以進一步的開發我們的範例，我們增加一個 <code>interface</code> 他描述了一個物件擁有兩個欄位 <code>firstName</code> 和<br><code>lastName</code> </p>
<p>在 <code>TypeScript</code> 中容許一個結構內擁有兩種類型只需要描述物件的輪廓</p>
<p>而不需要過於明確的解釋物件的值</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">lastName</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greeter</span>(<span class="params"><span class="attr">person</span>: <span class="title class_">Person</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> user = &#123; <span class="attr">firstName</span>: <span class="string">&quot;Jane&quot;</span>, <span class="attr">lastName</span>: <span class="string">&quot;User&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="title function_">greeter</span>(user);</span><br></pre></td></tr></table></figure>

<h4 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h4><p>最後我在做一些延伸</p>
<p><code>TypeScript</code> 支援 Javascript 使用 <code>class-based object-oriented programming</code></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript">Javascipt 的物件導向設計</a></p>
<p>我們再多建立一個 <code>Student</code> 的 class 中擁有 constructor 和一些 public 的欄位</p>
<p>讓 classes 和 interface 可以很好的共同使用，並且讓開發者可以選擇正確的抽象化他的程式碼</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">constuctor 是一個簡潔並且方便我們建立 <span class="keyword">object</span> 的參數 的函式</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">  <span class="attr">fullName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> <span class="attr">firstName</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> <span class="attr">middleInitial</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> <span class="attr">lastName</span>: <span class="built_in">string</span></span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fullName</span> = firstName + <span class="string">&quot; &quot;</span> + middleInitial + <span class="string">&quot; &quot;</span> + lastName;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">lastName</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greeter</span>(<span class="params"><span class="attr">person</span>: <span class="title class_">Person</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + person.<span class="property">firstName</span> + <span class="string">&quot; &quot;</span> + person.<span class="property">lastName</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> user = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Jane&quot;</span>, <span class="string">&quot;M.&quot;</span>, <span class="string">&quot;User&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="title function_">greeter</span>(user);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tsc greeter.ts</span><br></pre></td></tr></table></figure>

<p>然後你可以建立一個 greeter.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>TypeScript Greeter<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;greeter.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然後使用瀏覽器開啟這個 HTML 檔案 就可以看到相關的結果</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translate/" rel="tag">Translate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Leetcode-Q7" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/23/Leetcode-Q7/" class="article-date">
      <time datetime="2017-10-23T05:26:25.000Z" itemprop="datePublished">2017-10-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/23/Leetcode-Q7/">Leedcode-Q7</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Hamming-Distansce-漢明距離"><a href="#Hamming-Distansce-漢明距離" class="headerlink" title="Hamming Distansce (漢明距離)"></a>Hamming Distansce (漢明距離)</h1><h2 id="定義"><a href="#定義" class="headerlink" title="定義"></a>定義</h2><p>  將一個字符串變換成另一個字符串所需要替換的字符個數</p>
<h1 id="題目"><a href="#題目" class="headerlink" title="題目"></a>題目</h1><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">0</span> ≤ x, y &lt; <span class="number">231</span>.</span><br><span class="line"></span><br><span class="line"><span class="symbol">Input:</span> x = <span class="number">1</span>, y = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">Output:</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">Explanation:</span></span><br><span class="line"><span class="number">1</span>   (<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>)</span><br><span class="line"><span class="number">4</span>   (<span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>)</span><br><span class="line">       ↑   ↑</span><br><span class="line"></span><br><span class="line">The above arrows point <span class="keyword">to</span> positions <span class="keyword">where</span> the corresponding bits are different.</span><br></pre></td></tr></table></figure>

<p>將 1 轉為二進位的字串則是 <code>1</code>, 4 轉為二進位的字串則是 <code>1000</code></p>
<p>但是計算漢明距離時必須是兩個等長的符號</p>
<p>所以必須幫 <code>1</code> 補零為 <code>0001</code></p>
<p><code>0</code>00<code>1</code></p>
<p><code>1</code>00<code>0</code></p>
<p>所以需要替換兩個字符</p>
<p>所以回傳值為 2</p>
<h1 id="Javascript-的位元運算子"><a href="#Javascript-的位元運算子" class="headerlink" title="Javascript 的位元運算子"></a>Javascript 的位元運算子</h1><h2 id=""><a href="#" class="headerlink" title="^"></a>^</h2><p>XOR assignment</p>
<p>將數字轉為二進位之後再做比對的計算</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_XOR">Rule</a></p>
<p>3 ^ 5 &#x3D; 6</p>
<p><code>011</code></p>
<p><code>101</code></p>
<hr>
<p><code>110</code></p>
<p>再將 110 轉為十進制則為 6</p>
<p>也就是說當當兩個同位元做比對的規則是</p>
<p><code>數值相同則為 0 不相同則為 1</code><br><br>我們可以和另外一個運算子 | 做比較</p>
<p>因為在官方的範例中</p>
<p>他們的結果都是一樣的</p>
<p>但是測試之後結過卻還是不一樣</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h3><p>3 | 5 &#x3D; 7</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_OR">Rule</a></p>
<p><code>011</code></p>
<p><code>101</code></p>
<hr>
<p><code>111</code></p>
<p>再將 111 轉為十進制則為 7</p>
<p>也就是 OR 的比對規則是只要有一個為 1 就等於 1</p>
<h2 id="-1"><a href="#-1" class="headerlink" title="&amp;"></a>&amp;</h2><p>Bitwise AND assignment</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_AND">Rule</a></p>
<p>也就是說如果同位元的都為 1 才會等於 1</p>
<p>否則其餘狀況皆為零</p>
<h1 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">x</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">y</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">number</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> hammingDistance = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x || y)&#123;</span><br><span class="line">        ans += (x &amp; <span class="number">1</span>) ^ (y &amp; <span class="number">1</span>);</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>利用 while 迴圈</p>
<p>x &amp; 1 與 y &amp; 1 會取得最後一位檢查是否為零</p>
<p>若是 0 則為 0, 若為 1 則為 1</p>
<p>其結果在使用 XOR(^) 來作判斷是否相同</p>
<p>若同為 0 或 1 則回傳 0</p>
<p>若一個為 0 一個為 1 的時候回傳 1<br><br>將結果疊加在 ans 上</p>
<p>最後再將 x y 做<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Assignment_Operators#Right_shift_assignment">Right shift</a></p>
<p>之後再將 ans 回傳即為我們需要的結果</p>
<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB">漢明距離</a></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E9%87%8D%E9%87%8F">漢明重量</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators">Javascript 運算子</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Leetcode/">Leetcode</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Leetcode/" rel="tag">Leetcode</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-NPM-Publish-With-Gulp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/08/31/NPM-Publish-With-Gulp/" class="article-date">
      <time datetime="2017-08-31T01:01:45.000Z" itemprop="datePublished">2017-08-31</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/31/NPM-Publish-With-Gulp/">NPM publish with gulp</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="NPM-Publish"><a href="#NPM-Publish" class="headerlink" title="NPM Publish"></a>NPM Publish</h1><h2 id="Initial-Project"><a href="#Initial-Project" class="headerlink" title="Initial Project"></a>Initial Project</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> mkdir publishDemo</span><br><span class="line"><span class="symbol">$</span> yarn init</span><br><span class="line"><span class="comment">// question name (publishDemo):</span></span><br><span class="line"><span class="comment">// question version (1.0.0):</span></span><br><span class="line"><span class="comment">// question description: publishdemo</span></span><br><span class="line"><span class="comment">// question entry point (index.js):</span></span><br><span class="line"><span class="comment">// question repository url:</span></span><br><span class="line"><span class="comment">// question author: Tomas</span></span><br><span class="line"><span class="comment">// question license (MIT):</span></span><br><span class="line"><span class="comment">// success Saved package.json</span></span><br></pre></td></tr></table></figure>

<p>初始化結束後會增加一個 package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;publishDemo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;publishdemo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Tomas&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Create-index-js"><a href="#Create-index-js" class="headerlink" title="Create index.js"></a>Create index.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="string">&#x27;hello world&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> npm login</span><br><span class="line"><span class="comment">// 登入 NPM 的帳號並且驗證信箱</span></span><br></pre></td></tr></table></figure>

<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>npm publish</span><br><span class="line">+ publishdemotest<span class="variable">@1</span>.<span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../../../images/npmpublish/01.png" alt="npm publish success"></p>
<h2 id="add-Gulp"><a href="#add-Gulp" class="headerlink" title="add Gulp"></a>add Gulp</h2><p>gulpfile.js</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> src &amp;&amp; <span class="built_in">mv</span> index.js ./src</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&quot;gulp-babel&quot;</span>);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;compile&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;./src/**/*.js&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">babel</span>(&#123;</span><br><span class="line">        <span class="attr">presets</span>: [<span class="string">&quot;es2015&quot;</span>, <span class="string">&quot;stage-2&quot;</span>],</span><br><span class="line">        <span class="attr">plugins</span>: []</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./build&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;default&quot;</span>, [<span class="string">&quot;compile&quot;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ gulp</span><br><span class="line"><span class="comment">// result</span></span><br><span class="line">.</span><br><span class="line">├── build</span><br><span class="line">│   └── index<span class="selector-class">.js</span></span><br><span class="line">├── gulpfile<span class="selector-class">.js</span></span><br><span class="line">├── package<span class="selector-class">.json</span></span><br><span class="line">├── <span class="attribute">src</span></span><br><span class="line">│   └── index<span class="selector-class">.js</span></span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure>

<h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><p>.gitignore</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Logs</span></span><br><span class="line">logs</span><br><span class="line">*<span class="string">.log</span></span><br><span class="line">npm-debug.log*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Runtime data</span></span><br><span class="line">pids</span><br><span class="line">*<span class="string">.pid</span></span><br><span class="line">*<span class="string">.seed</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory for instrumented libs generated by jscoverage/JSCover</span></span><br><span class="line">lib-cov</span><br><span class="line"></span><br><span class="line"><span class="comment"># Coverage directory used by tools like istanbul</span></span><br><span class="line">coverage</span><br><span class="line"></span><br><span class="line"><span class="comment"># Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)</span></span><br><span class="line"><span class="string">.grunt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># node-waf configuration</span></span><br><span class="line"><span class="string">.lock-wscript</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compiled binary addons (http://nodejs.org/api/addons.html)</span></span><br><span class="line">build/Release</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dependency directory</span></span><br><span class="line"><span class="comment"># https://docs.npmjs.com/misc/faq#should-i-check-my-node-modules-folder-into-git</span></span><br><span class="line">node_modules</span><br><span class="line">build</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/horsekitlin/npmpublishwithgulp">publishdemo</a></p>
<h3 id="update-NPM-version-and-main"><a href="#update-NPM-version-and-main" class="headerlink" title="update NPM version and main"></a>update NPM version and main</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;publishdemotest&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;publishdemo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./build/index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Tomas&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;babel-core&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.26.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;babel-plugin-transform-runtime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.23.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;babel-preset-es2015&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.24.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;babel-preset-stage-0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.24.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gulp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.9.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gulp-babel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="重新-publish"><a href="#重新-publish" class="headerlink" title="重新 publish"></a>重新 publish</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>npm publish</span><br><span class="line"><span class="regexp">//</span>+ publishdemotest<span class="variable">@1</span>.<span class="number">0.1</span></span><br></pre></td></tr></table></figure>

<p>這時如果我在其他專案從 NPM 下載結果如下圖</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn <span class="built_in">add</span> publishdemotest</span><br></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  $ tree ./node_modules/publishdemotest</span><br><span class="line">  <span class="comment">//result</span></span><br><span class="line"></span><br><span class="line">./node_modules/publishdemotest</span><br><span class="line">├── gulpfile<span class="selector-class">.js</span></span><br><span class="line">├── package<span class="selector-class">.json</span></span><br><span class="line">├── <span class="attribute">src</span></span><br><span class="line">│   └── index<span class="selector-class">.js</span></span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure>

<p>並沒有build 這個 folder</p>
<p>但是因為在 package.json 中我們將進入點設定為 <code>./build/index.js</code></p>
<p>所以會造成我們引入時的錯誤</p>
<p>NPM 會自動將 .gitignore 設定為預設的設定檔案</p>
<p>但是我們希望可以有其他的設定</p>
<p>我們可以增加一個 .npmignore</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Logs</span></span><br><span class="line"><span class="attribute">logs</span></span><br><span class="line"><span class="regexp">*.log</span></span><br><span class="line">npm-<span class="literal">debug</span>.log*</span><br><span class="line">node_modules</span><br><span class="line"></span><br><span class="line">*<span class="literal">error</span>*</span><br></pre></td></tr></table></figure>

<p>我們將build 移除在 .npmignore 中</p>
<p>再將 package.json 的version 升級</p>
<p>再重新publish 一次</p>
<p>在 Demo 的 project 升級 package</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>yarn upgrade publishdemotest</span><br></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ tree node_modules/publishdemotest</span><br><span class="line"></span><br><span class="line">node_modules/publishdemotest</span><br><span class="line">├── build</span><br><span class="line">│   └── index<span class="selector-class">.js</span></span><br><span class="line">├── gulpfile<span class="selector-class">.js</span></span><br><span class="line">├── package<span class="selector-class">.json</span></span><br><span class="line">├── <span class="attribute">src</span></span><br><span class="line">│   └── index<span class="selector-class">.js</span></span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure>

<p>透過 .npmignore 就可以達到我們需要的效果</p>
<p>同樣如果不希望使用者還需要安裝相關套件</p>
<p>也可以把 node_modules 移除 .npmignore 中</p>
<p>如此使用者就不需要安裝相關套件</p>
<p>也可以達到鎖定版本的效果</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-ReactUnitestWithJest" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/07/31/ReactUnitestWithJest/" class="article-date">
      <time datetime="2017-07-31T04:23:09.000Z" itemprop="datePublished">2017-07-31</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/31/ReactUnitestWithJest/">ReactUnitestWithJest</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h1><h2 id="Create-React-App"><a href="#Create-React-App" class="headerlink" title="Create React App"></a>Create React App</h2><p><a target="_blank" rel="noopener" href="https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#running-tests">Run the test</a></p>
<h2 id="Without-Create-React-App"><a href="#Without-Create-React-App" class="headerlink" title="Without Create React App"></a>Without Create React App</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm <span class="keyword">install </span>--save-dev <span class="keyword">jest </span><span class="keyword">babel-jest </span><span class="keyword">babel-preset-es2015 </span><span class="keyword">babel-preset-react </span>react-test-renderer</span><br></pre></td></tr></table></figure>

<p>.babelrc</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;es2015&quot;</span><span class="punctuation">,</span> <span class="string">&quot;react&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>先寫一個 React Component Link Example</p>
<p>Link.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">STATUS</span> = &#123;</span><br><span class="line">  <span class="attr">HOVERED</span>: <span class="string">&#x27;hovered&#x27;</span>,</span><br><span class="line">  <span class="attr">NORMAL</span>: <span class="string">&#x27;normal&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Link</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_onMouseEnter</span> = <span class="variable language_">this</span>.<span class="property">_onMouseEnter</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_onMouseLeave</span> = <span class="variable language_">this</span>.<span class="property">_onMouseLeave</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">class</span>: <span class="variable constant_">STATUS</span>.<span class="property">NORMAL</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_onMouseEnter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">class</span>: <span class="variable constant_">STATUS</span>.<span class="property">HOVERED</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_onMouseLeave</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">class</span>: <span class="variable constant_">STATUS</span>.<span class="property">NORMAL</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">a</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&#123;this.state.class&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">href</span>=<span class="string">&#123;this.props.page</span> || &#x27;#&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onMouseEnter</span>=<span class="string">&#123;this._onMouseEnter&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onMouseLeave</span>=<span class="string">&#123;this._onMouseLeave&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.props.children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>__tests__/Link.test.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Link</span> <span class="keyword">from</span> <span class="string">&#x27;../Link.react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> renderer <span class="keyword">from</span> <span class="string">&#x27;react-test-renderer&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;Link changes the class when hovered&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> component = renderer.<span class="title function_">create</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">page</span>=<span class="string">&quot;http://www.facebook.com&quot;</span>&gt;</span>Facebook<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">let</span> tree = component.<span class="title function_">toJSON</span>();</span><br><span class="line">  <span class="title function_">expect</span>(tree).<span class="title function_">toMatchSnapshot</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// manually trigger the callback</span></span><br><span class="line">  tree.<span class="property">props</span>.<span class="title function_">onMouseEnter</span>();</span><br><span class="line">  <span class="comment">// re-rendering</span></span><br><span class="line">  tree = component.<span class="title function_">toJSON</span>();</span><br><span class="line">  <span class="title function_">expect</span>(tree).<span class="title function_">toMatchSnapshot</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// manually trigger the callback</span></span><br><span class="line">  tree.<span class="property">props</span>.<span class="title function_">onMouseLeave</span>();</span><br><span class="line">  <span class="comment">// re-rendering</span></span><br><span class="line">  tree = component.<span class="title function_">toJSON</span>();</span><br><span class="line">  <span class="title function_">expect</span>(tree).<span class="title function_">toMatchSnapshot</span>();</span><br></pre></td></tr></table></figure>

<p><code>__tests__/__snashots__/Link.test.js.snap</code></p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">// Jest Snapshot v1, https://g</span>oo.gl/fbAQLP</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>[`Link changes the <span class="keyword">class</span> <span class="title class_">when</span> hovered <span class="number">1</span>`] = `</span><br><span class="line">&lt;a</span><br><span class="line">  className=<span class="string">&quot;normal&quot;</span></span><br><span class="line">  href=<span class="string">&quot;http://www.facebook.com&quot;</span></span><br><span class="line">  onMouseEnter=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">  onMouseLeave=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">&gt;</span><br><span class="line">  Facebook</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>[`Link changes the <span class="keyword">class</span> <span class="title class_">when</span> hovered <span class="number">2</span>`] = `</span><br><span class="line">&lt;a</span><br><span class="line">  className=<span class="string">&quot;hovered&quot;</span></span><br><span class="line">  href=<span class="string">&quot;http://www.facebook.com&quot;</span></span><br><span class="line">  onMouseEnter=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">  onMouseLeave=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">&gt;</span><br><span class="line">  Facebook</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>[`Link changes the <span class="keyword">class</span> <span class="title class_">when</span> hovered <span class="number">3</span>`] = `</span><br><span class="line">&lt;a</span><br><span class="line">  className=<span class="string">&quot;normal&quot;</span></span><br><span class="line">  href=<span class="string">&quot;http://www.facebook.com&quot;</span></span><br><span class="line">  onMouseEnter=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">  onMouseLeave=&#123;[<span class="built_in">Function</span>]&#125;</span><br><span class="line">&gt;</span><br><span class="line">  Facebook</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">`;</span><br></pre></td></tr></table></figure>

<p>測試的時候每次呼叫 <code>toMatchSnapshot</code> 的時候</p>
<p>會依序會依序在 <code>__tests__/__snashots__/Link.test.js.snap</code> 中</p>
<p>取得取得 Mock 做比對</p>
<p>需要完全吻合才會回傳正確</p>
<h2 id="DOM-Testing"><a href="#DOM-Testing" class="headerlink" title="DOM Testing"></a>DOM Testing</h2><p>上述的範例是單純比較依據不同的 Input 後造成的 Component 比對</p>
<p>若是你需要操作這些實體化的 <code>Component</code> 則可以使用 <a target="_blank" rel="noopener" href="http://airbnb.io/enzyme/">Enzyme</a> 或是 React 的 </p>
<p><a target="_blank" rel="noopener" href="http://facebook.github.io/react/docs/test-utils.html">TestUtils</a></p>
<p>而下述範例則使用 <strong>Enzyme</strong></p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>CheckboxWithLabel.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">CheckboxWithLabel</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;<span class="attr">isChecked</span>: <span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// bind manually because React class components don&#x27;t auto-bind</span></span><br><span class="line">    <span class="comment">// http://facebook.github.io/react/blog/2015/01/27/react-v0.13.0-beta-1.html#autobinding</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">onChange</span> = <span class="variable language_">this</span>.<span class="property">onChange</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">isChecked</span>: !<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isChecked</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">checked</span>=<span class="string">&#123;this.state.isChecked&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;this.onChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.state.isChecked ? this.props.labelOn : this.props.labelOff&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 Enzyme 的 <a target="_blank" rel="noopener" href="http://airbnb.io/enzyme/docs/api/shallow.html">shallow renderer</a></p>
<p><code>__tests__/CheckboxWithdLabel.test.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;shallow&#125; <span class="keyword">from</span> <span class="string">&#x27;enzyme&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CheckboxWithLabel</span> <span class="keyword">from</span> <span class="string">&#x27;../CheckboxWithLabel&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;CheckboxWithLabel changes the text after click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Render a checkbox with label in the document</span></span><br><span class="line">  <span class="keyword">const</span> checkbox = <span class="title function_">shallow</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">CheckboxWithLabel</span> <span class="attr">labelOn</span>=<span class="string">&quot;On&quot;</span> <span class="attr">labelOff</span>=<span class="string">&quot;Off&quot;</span> /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="title function_">expect</span>(checkbox.<span class="title function_">text</span>()).<span class="title function_">toEqual</span>(<span class="string">&#x27;Off&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  checkbox.<span class="title function_">find</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">simulate</span>(<span class="string">&#x27;change&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">expect</span>(checkbox.<span class="title function_">text</span>()).<span class="title function_">toEqual</span>(<span class="string">&#x27;On&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p><a target="_blank" rel="noopener" href="https://facebook.github.io/jest/docs/tutorial-react.html#content">jest Testing React Apps</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Python-Decorator" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/10/Python-Decorator/" class="article-date">
      <time datetime="2017-06-10T08:58:58.000Z" itemprop="datePublished">2017-06-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/10/Python-Decorator/">Python-Decorator</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h1><p>在網路上最常看到的範例</p>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logged</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">with_logging</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span> func.__name__ + <span class="string">&quot; was called&quot;</span></span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> with_logging</span><br><span class="line"></span><br><span class="line"><span class="meta">@logged</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x + x * x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> f(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>在  <code>logger</code> 中定義一個 Function <code>with_logging</code></p>
<p>在執行前 <code>f</code> 會被當成參數 <code>func</code> 傳入 <code>logged</code>中</p>
<p>而 <code>with_logging</code> 會優先被執行</p>
<p>執行後才會執行 <code>func</code></p>
<p>上面的程式碼也會等於</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logged</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">with_logging</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span> func.__name__ + <span class="string">&quot; was called&quot;</span></span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> with_logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>): </span><br><span class="line">   <span class="keyword">return</span> x + x * x</span><br><span class="line"></span><br><span class="line">f = logged(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> f(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>執行後的結果是一樣的</p>
<p>看起來要使用 <strong>Decorator</strong> 所有的操作都會在 Function  上 </p>
<p>傳入與回傳值都是 Function </p>
<p>再來就是如果有多個裝飾子</p>
<p>那麼順序又如何決定的呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">makebold</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;b&gt;&quot;</span> + fn() + <span class="string">&quot;&lt;/b&gt;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeitalic</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;i&gt;&quot;</span> + fn() + <span class="string">&quot;&lt;/i&gt;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@makeitalic</span></span><br><span class="line"><span class="meta">@makebold</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> hello()</span><br><span class="line"></span><br><span class="line"><span class="comment"># result: &lt;i&gt;&lt;b&gt;hello world&lt;/b&gt;&lt;/i&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到順序會先包 <code>makeblod</code> 然後再來才是 <code>makeitalic </code></p>
<p>執行順序是由下往上</p>
<p>也可以把 <code>decorator</code> 當成是 recurcive 理解</p>
<p># Class 的  Decorator</p>
<h2 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h2><pre><code class="python">class entryExit(object):
    def __init__(self, f):
        print &#39;entry init enter&#39;
        self.f = f
        print &#39;entry init exit&#39;

    def __call__(self, *args):
        print &#39;Entering&#39;, self.f.__name__
        r = self.f(*args)
        print &#39;Exit&#39;, self.f.__name__
        return r
print &#39;decorator using&#39;

@entryExit
def hello(a):
    print &#39;inside hello&#39;
    return &#39;hello world&#39; + a

print &#39;test start&#39;
print hello(&#39;friends&#39;)

&#39;&#39;&#39;
result:
---------------------
decorator using
entry init enter
entry init exit
test start
Entering hello
inside hello
Exit hello
hello worldfriends
&#39;&#39;&#39;

比較一開始的函式例子跟後來的類別例子

雖然識別字指的一個是類別

一個是函數

在程式碼中

在函式名後面加上()

變成函式呼叫

而類別本來是不能被呼叫的(not callable)

但加上類別方法__call__之後

就變得可以被呼叫

從程式的結果來看 test start 出現在 entry init exit 的後面

代表在 print &#39;test start&#39; 之前

entryExit 就已實例化

應該就是 @entryExit 這句執行的

當程式執行到 hello(&#39;friend&#39;) 的時候

先進入的是 entryExit 的 __call__

後來才是 hello 自己的內容

這樣的流程觀察比較清楚

但是 cpython 倒底如何實作這段

這個例子很漂亮的介紹兩件事

第一件事是 decorator

第二件事就是 python 函式與物件之間的巧妙關聯
</code></pre>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Debugging-Nodejs-With-VSCode" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/09/Debugging-Nodejs-With-VSCode/" class="article-date">
      <time datetime="2017-06-09T02:27:20.000Z" itemprop="datePublished">2017-06-09</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/09/Debugging-Nodejs-With-VSCode/">Debugging-Nodejs-With-VSCode</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="環境"><a href="#環境" class="headerlink" title="環境"></a>環境</h1><ul>
<li>Nodejs - 7.9.10</li>
<li>VSCode - 1.12.2</li>
</ul>
<h1 id="Download-VSCode"><a href="#Download-VSCode" class="headerlink" title="Download VSCode"></a>Download VSCode</h1><p><a target="_blank" rel="noopener" href="https://www.google.com.tw/search?q=vscode+downlload&oq=vscode+downlload&aqs=chrome..69i57.2744j0j4&sourceid=chrome&ie=UTF-8">vscode</a></p>
<p><img src="/../../../../images/vscode/bug.png" alt="Image"></p>
<p>點擊這個 Icon 後再點擊齒輪會自動產生 <strong>launch.json</strong></p>
<h1 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Launch Program&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;protocol&quot;</span><span class="punctuation">:</span> <span class="string">&quot;inspector&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceRoot&#125;/index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceRoot&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;runtimeArgs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;--nolazy&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;--inspect-brk&quot;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;console&quot;</span><span class="punctuation">:</span> <span class="string">&quot;integratedTerminal&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;NODE_ENV&quot;</span><span class="punctuation">:</span> <span class="string">&quot;development&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>console - 在Terminal 中啟動程式</li>
<li>env - 設定動態變數，可以傳入程式中使用</li>
<li>runtimeArgs - 動態參數</li>
<li>program - 啟動程式路徑</li>
<li>protocol - npm 8 有兩種不同的protocol ,  預設是 legacy</li>
</ul>
<p>檢查launch.json</p>
<p><img src="/../../../../images/vscode/debugcheck.png" alt="debug"></p>
<p>開始 debug 後上方會多一條控制 bar</p>
<p><img src="/../../../../images/vscode/debugrun.png" alt="debug"></p>
<p>使用 postman 發送 Request</p>
<p><img src="/../../../../images/vscode/postman.png" alt="debug"></p>
<p>因為我有 console.log 所以在 Debug Console 中會把 login 顯示出來</p>
<p><img src="/../../../../images/vscode/response.png" alt="debug"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VSCode/" rel="tag">VSCode</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-NodeDesignPatten-06" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/31/NodeDesignPatten-06/" class="article-date">
      <time datetime="2017-05-31T10:52:12.000Z" itemprop="datePublished">2017-05-31</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/31/NodeDesignPatten-06/">NodeDesignPatten-06</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Design-Patten"><a href="#Design-Patten" class="headerlink" title="Design Patten"></a>Design Patten</h1><p>設計模式是關於程式碼重複使用的問題</p>
<p>推薦書籍</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://sophia.javeriana.edu.co/~cbustaca/docencia/DSBP-2016-03/recursos/Erich%20Gamma,%20Richard%20Helm,%20Ralph%20Johnson,%20John%20M.%20Vlissides-Design%20Patterns_%20Elements%20of%20Reusable%20Object-Oriented%20Software%20%20-Addison-Wesley%20Professional%20(1994).pdf">Elements of Reusable Object-Oriented Software</a></li>
<li><a target="_blank" rel="noopener" href="http://www.pearsoned.co.uk/bookshop/ebooks">Pearson Education</a></li>
<li><a target="_blank" rel="noopener" href="http://www.uml.org.cn/c++/pdf/DesignPatterns.pdf"> Gang of Four (GoF)</a></li>
</ul>
<h2 id="Design-Pattern-List"><a href="#Design-Pattern-List" class="headerlink" title="Design Pattern List"></a>Design Pattern List</h2><ul>
<li>Factory</li>
<li>Revealing constructor</li>
<li>Proxy</li>
<li>Decorator</li>
<li>Adapter</li>
<li>Strategy</li>
<li>State</li>
<li>Template</li>
<li>Middleware</li>
<li>Command</li>
</ul>
<h3 id="Factory"><a href="#Factory" class="headerlink" title="Factory"></a>Factory</h3><p>在 Javascript 中 設計通常以可用，簡單並且模組化開發為主旨</p>
<p>而使用 <strong>Factory</strong> 則可以在物件導向上包覆一層 Wrapper </p>
<p>使用上可以更加彈性</p>
<p>在 Factory 中可以透過 Object.create() 來建立一個物件</p>
<p>或是利用特定的條件來建立不同的物件</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>factory.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ImageJpeg</span> = <span class="built_in">require</span>(<span class="string">&#x27;./imageJpeg&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ImageGif</span> = <span class="built_in">require</span>(<span class="string">&#x27;./imageGif&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ImagePng</span> = <span class="built_in">require</span>(<span class="string">&#x27;./imagePng&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createImage</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (name.<span class="title function_">match</span>(<span class="regexp">/\.jpe?g$/</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ImageJpeg</span>(name);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.<span class="title function_">match</span>(<span class="regexp">/\.gif$/</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ImageGif</span>(name);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.<span class="title function_">match</span>(<span class="regexp">/\.png$/</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ImagePng</span>(name);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&#x27;Unsupported format&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> image1 = <span class="title function_">createImage</span>(<span class="string">&#x27;photo.jpg&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> image2 = <span class="title function_">createImage</span>(<span class="string">&#x27;photo.gif&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> image3 = <span class="title function_">createImage</span>(<span class="string">&#x27;photo.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(image1, image2, image3);</span><br></pre></td></tr></table></figure>

<p>imageJpeg.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Image</span> = <span class="built_in">require</span>(<span class="string">&#x27;./image&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">ImageJpg</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Image</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!path.<span class="title function_">match</span>(<span class="regexp">/\.jpe?g$/</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`<span class="subst">$&#123;path&#125;</span> is not a JPEG image`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">super</span>(path);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>imagePng.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Image</span> = <span class="built_in">require</span>(<span class="string">&#x27;./image&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">ImagePng</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Image</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!path.<span class="title function_">match</span>(<span class="regexp">/\.png$/</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`<span class="subst">$&#123;path&#125;</span> is not a PNG image`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">super</span>(path);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>imageGif.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Image</span> = <span class="built_in">require</span>(<span class="string">&#x27;./image&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">ImageGif</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Image</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!path.<span class="title function_">match</span>(<span class="regexp">/\.gif/</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`<span class="subst">$&#123;path&#125;</span> is not a GIF image`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">super</span>(path);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="封裝"><a href="#封裝" class="headerlink" title="封裝"></a>封裝</h2><p>封裝是防止某些程式碼被外部直接飲用或更改時使用</p>
<p>也稱為訊息隱藏</p>
<p>而 Javascript 常用 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)">Closure</a> 來實現</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> privateProperties = &#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> person = &#123;</span><br><span class="line">    <span class="attr">setName</span>: <span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!name) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;A person must have a name&#x27;</span>);</span><br><span class="line">      privateProperties.<span class="property">name</span> = name;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getName</span>: <span class="function">() =&gt;</span> privateProperties.<span class="property">name</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  person.<span class="title function_">setName</span>(name);</span><br><span class="line">  <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = <span class="title function_">createPerson</span>(<span class="string">&#x27;Tomas Lin&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="title function_">getName</span>(), person);</span><br></pre></td></tr></table></figure>

<p>此範例中的person 只有透過 setName與 getName可以對person 取值與修改</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用 Factory 只是其中一個方式</span><br><span class="line"></span><br><span class="line">另外也有不成文約定</span><br><span class="line"></span><br><span class="line">在<span class="keyword">function</span> <span class="title">前加上</span> **_** 或 **$**</span><br><span class="line"></span><br><span class="line">但是這樣依舊可以在外部呼叫</span><br><span class="line"></span><br><span class="line">另外也可以使用 [WeakMap](http://fitzgeraldnick.com/2014/01/13/hiding-implementation-details-<span class="keyword">with</span>-e6-weakmaps.html) </span><br></pre></td></tr></table></figure>

<h2 id="建立一個完整的-Factory-Demo"><a href="#建立一個完整的-Factory-Demo" class="headerlink" title="建立一個完整的 Factory Demo"></a>建立一個完整的 Factory Demo</h2><p>profiler.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Profiler</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">label</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">label</span> = label;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastTime</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastTime</span> = process.<span class="title function_">hrtime</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">end</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> diff = process.<span class="title function_">hrtime</span>(<span class="variable language_">this</span>.<span class="property">lastTime</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">`Timer &quot;<span class="subst">$&#123;<span class="variable language_">this</span>.label&#125;</span>&quot; took <span class="subst">$&#123;diff[<span class="number">0</span>]&#125;</span> seconds and <span class="subst">$&#123;diff[<span class="number">1</span>]&#125;</span> nanoseconds.`</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">label</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Profiler</span>(label);        <span class="comment">//[1]</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;             <span class="comment">//[2]</span></span><br><span class="line">      <span class="attr">start</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;,</span><br><span class="line">      <span class="attr">end</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Must set NODE_ENV&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>profilerTest.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> profiler = <span class="built_in">require</span>(<span class="string">&#x27;./profile&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandomArray</span>(<span class="params">len</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> p = <span class="title function_">profiler</span>(<span class="string">`Generating a <span class="subst">$&#123;len&#125;</span> items long array`</span>);</span><br><span class="line">  p.<span class="title function_">start</span>();</span><br><span class="line">  <span class="keyword">const</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  p.<span class="title function_">end</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getRandomArray</span>(<span class="number">1e6</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Done&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="attr">NODE_ENV=</span>development <span class="keyword">node</span> <span class="title">profilerTest</span></span><br></pre></td></tr></table></figure>

<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="attr">NODE_ENV=</span>production <span class="keyword">node</span> <span class="title">profilerTest</span></span><br></pre></td></tr></table></figure>

<h2 id="組合工廠"><a href="#組合工廠" class="headerlink" title="組合工廠"></a>組合工廠</h2><p>利用遊戲的方式來解說</p>
<p>通常一種遊戲會有多種角色</p>
<p>每種角色會擁有各自不同的基本能力</p>
<ul>
<li>Runner: 可移動</li>
<li>Samurai: 可移動並且攻擊</li>
<li>Sniper: 可射擊但不可移動</li>
<li>Gunslinger: 可移動並且射擊</li>
<li>Western Samurai: 可以移動 攻擊 並射擊</li>
</ul>
<p>希望上述可以自由地互相結合</p>
<p>所以不能使用 Class 或是 inheritance 來解決</p>
<h2 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h2><p>使用套件<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/stampit">stampit</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Designpatten/">Designpatten</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DesignPatten/" rel="tag">DesignPatten</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/7/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/9/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2024 Tomas Lin
            </div>
            <!-- <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div> -->
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>